@import
  'abstracts/variables.scss';

@import
  'field/markdown-field.scss';

:root {
  --cm-line-margin: .375rem;
  --cm-line-height: 1.5;

  --cm-color-meta: #aaa;
  --cm-color-light-gray: rgba(0,0,0,.1);
  --cm-selection-background: hsla(195, 80%, 40%, .16);
}

// @import
//   'themes/default.scss',
//   'themes/custom.scss',
//   'themes/options.scss';

.cm-codeblock {
  background: rgba(0, 0, 0, .04);

}

.cm-heading {
  text-indent: calc((var(--cm-indent) + 1) * -1ch);
  padding-left: calc((var(--cm-indent) + 1) * 1ch) !important;
}

.cm-blockquote {
  border-left: .25rem solid rgba(0,0,0,.1);
  padding-left: calc(var(--cm-indent) - .25rem);
  padding-left: 1ch !important;
}

.cm-ol {
  padding-left: 3ch !important;
  text-indent: -3ch;
}

.cm-ul {
  padding-left: 2ch !important;
  text-indent: -2ch;
}

.cm-hr {
  display: flex !important;
  text-align: center;
}

.cm-hr::before,
.cm-hr::after {
  content: "";
  flex-grow: 1;
  background: linear-gradient(var(--cm-color-light-gray), var(--cm-color-light-gray)) 50% calc(50% + .0625rem) / 100% .0625rem no-repeat;
}

.cm-hr > span {
  flex-grow: 0;
  padding: 0 1ch;
}

.cm-kirbytag {
  padding: 1px 0 1px;
  margin: -1px 0 0px;
  background: rgba(66,113,174,.15);
  border: 1px solid rgba(66,113,174,.3);
  border-width: 1px 0;
  box-decoration-break: clone;
}

/**
 * 1. Override highlighting colors inside Kirbytags to ensure,
 *    that thereâ€™s enough contrast between text and the tag background.
 */
.cm-kirbytag * {
  color: currentColor; /* 1 */
}

.cm-kirbytag-open {
  border-left-width: 1px;
  margin-left: -1px;
  border-radius: 2px 0 0 2px;
}

.cm-kirbytag-close {
  border-right-width: 1px;
  margin-right: -1px;
  border-radius: 0 2px 2px 0;
}

/**
 * Custom highlights
 */
[class*=" cm-token-"],
[class^="cm-token-"] {
  padding: 1px 0;
  margin: -2px -1px;
  border-radius: 2px;
  background: var(--token-background, rgba(0,0,0,.05));
  border: 1px solid var(--token-border, rgba(0,0,0,.1));
  color: var(--color-text, #000);

  > * {
    color: currentColor;
  }
}

// https://github.com/getkirby/getkirby.com/blob/master/src/scss/variables.scss

.cm-token-red {
  --token-background: rgba(255, 0, 0, .12);
  --token-border: rgba(255, 0, 0, .25);
}

.cm-token-purple {
  --token-background: hsla(285, 44%, 50%, .17);
  --token-border: hsla(285, 44%, 50%, .4);
}

/**
 * Special chars
 */

 .cm-specialChar {
   cursor: text;
 }

/* Space */
.cm-specialChar[data-code="32"] {
  word-break: break-all;
  $c: #f8a752;
  background: linear-gradient($c, $c) 50% calc(50% + 1px) / 2px 2px no-repeat;
}

/* No-Break Space */
.cm-specialChar[data-code="160"] {
  $c: #f8a752;
  background:
    linear-gradient($c, $c) 1px 100% / 1px 2px no-repeat,
    linear-gradient($c, $c) 1px 100% / calc(100% - 2px) 1px no-repeat,
    linear-gradient($c, $c) calc(100% - 1px) 100% / 1px 2px no-repeat;
  color: transparent;
}

/* Soft Hyphen */
.cm-specialChar[data-code="173"] {
  margin-left: -1px;
  position: relative;
  left: .5px;
  border-left: 1px solid #f8a752;
}

/* Zero-Width Space */
.cm-specialChar[data-code="8203"] {
  padding-left: 3px;
  margin-left: -1.5px;
  margin-right: -1.5px;
  margin-bottom: -4px;
  margin-top: -4px;
  padding-bottom: 2px;
  padding-top: 2px;
  background: url("data:image/svg+xml,%3Csvg width='3' height='23' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M2 2.915v17.17a1.5 1.5 0 11-1 0V2.915a1.5 1.5 0 111 0zM1.5 2a.5.5 0 100-1 .5.5 0 000 1zm0 20a.5.5 0 100-1 .5.5 0 000 1z' fill='%23f8a752' fill-rule='nonzero'/%3E%3C/svg%3E%0A") no-repeat;
}

/* Tab character */
.cm-tab {
  $arrow: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='11' height='7' viewBox='0 0 11 7'%3E%3Cpath fill='%23f8a752' d='M9.85355339,3.14644661 C9.94403559,3.23692881 10,3.36192881 10,3.5 C10,3.63807119 9.94403559,3.76307119 9.85355339,3.85355339 L7.85355339,5.85355339 C7.65829124,6.04881554 7.34170876,6.04881554 7.14644661,5.85355339 C6.95118446,5.65829124 6.95118446,5.34170876 7.14644661,5.14644661 L8.29289322,4 L1.5,4 C1.22385763,4 1,3.77614237 1,3.5 C1,3.22385763 1.22385763,3 1.5,3 L8.29289322,3 L7.14644661,1.85355339 C6.95118446,1.65829124 6.95118446,1.34170876 7.14644661,1.14644661 C7.34170876,0.951184464 7.65829124,0.951184464 7.85355339,1.14644661 L9.85355339,3.14644661 Z'/%3E%3C/svg%3E%0A");
  background: $arrow center no-repeat;
}
